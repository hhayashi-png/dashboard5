<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>å–¶æ¥­ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&family=Zen+Maru+Gothic:wght@400;500;700&display=swap" rel="stylesheet">
<style>
:root{--gd:#1B7A4E;--gm:#2EAD6D;--gl:#E8F5EE;--gp:#F0FAF4;--ps:#FFE4EC;--pa:#FF8FAB;--pt:#D4547A;--bs:#E3F2FD;--ba:#64B5F6;--bt:#3478BE;--w:#FFF;--g50:#FAFAFA;--g1:#F5F5F5;--g2:#EEE;--g3:#E0E0E0;--g5:#9E9E9E;--g7:#616161;--g9:#212121;--ss:0 1px 3px rgba(0,0,0,.06);--sl:0 8px 24px rgba(0,0,0,.1);--r:10px}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Noto Sans JP',sans-serif;background:linear-gradient(145deg,var(--gp),var(--w) 40%,var(--bs));min-height:100vh;color:var(--g9);-webkit-font-smoothing:antialiased;max-width:480px;margin:0 auto;padding-bottom:80px}
.hd{background:linear-gradient(135deg,var(--gd),var(--gm));padding:20px 20px 24px;color:#fff;position:sticky;top:0;z-index:100;box-shadow:var(--sl)}
.hd-t{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}
.hd h1{font-family:'Zen Maru Gothic',sans-serif;font-size:18px;font-weight:700}
.hd .dl{font-size:12px;opacity:.85}.hd .pr{font-size:11px;opacity:.7;margin-top:2px}
.rb{background:rgba(255,255,255,.2);border:1px solid rgba(255,255,255,.3);color:#fff;padding:4px 10px;border-radius:16px;font-size:11px;cursor:pointer;font-family:'Noto Sans JP',sans-serif;text-decoration:none}
.tabs{display:flex;gap:6px;padding:12px 16px;background:var(--w);border-bottom:1px solid var(--g2);overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none}.tabs::-webkit-scrollbar{display:none}
.tb{flex-shrink:0;padding:8px 16px;border-radius:20px;font-size:13px;font-weight:500;border:none;cursor:pointer;transition:all .25s;background:var(--g1);color:var(--g7);font-family:'Noto Sans JP',sans-serif}
.tb.a{background:var(--gm);color:#fff;box-shadow:0 2px 8px rgba(46,173,109,.3)}
.ct{padding:16px}
.st{font-family:'Zen Maru Gothic',sans-serif;font-size:15px;font-weight:700;color:var(--gd);margin:20px 0 12px;display:flex;align-items:center;gap:6px}.st:first-child{margin-top:4px}
.sg{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:8px}
.sc{background:var(--w);border-radius:var(--r);padding:14px;box-shadow:var(--ss);border:1px solid var(--g2)}
.sc.gr{border-left:4px solid var(--gm)}.sc.pk{border-left:4px solid var(--pa)}.sc.bl{border-left:4px solid var(--ba)}
.sc .lb{font-size:11px;color:var(--g5);font-weight:500;margin-bottom:4px}
.sc .vl{font-size:22px;font-weight:700;font-family:'Zen Maru Gothic',sans-serif}
.sc.gr .vl{color:var(--gd)}.sc.pk .vl{color:var(--pt)}.sc.bl .vl{color:var(--bt)}
.sc .sb{font-size:10px;color:var(--g5);margin-top:2px}
.rl{display:flex;flex-direction:column;gap:8px}
.sr{background:var(--w);border-radius:var(--r);padding:12px 14px;box-shadow:var(--ss);border:1px solid var(--g2);display:flex;align-items:center;gap:10px;cursor:pointer;transition:all .2s}.sr:active{transform:scale(.98);background:var(--gp)}
.rb2{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0}
.r1{background:linear-gradient(135deg,#FFD700,#FFA000);color:#fff}.r2{background:linear-gradient(135deg,#C0C0C0,#9E9E9E);color:#fff}.r3{background:linear-gradient(135deg,#CD7F32,#A0522D);color:#fff}.ro{background:var(--g1);color:var(--g5)}
.si{flex:1;min-width:0}.sn{font-size:13px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.ss2{display:flex;gap:8px;margin-top:3px}.s1{font-size:10px;color:var(--g5)}.s1 span{font-weight:600}.s1.gr span{color:var(--gm)}.s1.pk span{color:var(--pt)}
.sa{color:var(--g3);font-size:16px;flex-shrink:0}
.pb{height:6px;background:var(--g1);border-radius:3px;overflow:hidden;margin-top:6px}
.pf{height:100%;border-radius:3px;transition:width .6s}.pf.gr{background:linear-gradient(90deg,var(--gm),#4FD080)}.pf.pk{background:linear-gradient(90deg,var(--pa),#FFB6C8)}.pf.bl{background:linear-gradient(90deg,var(--ba),#90CAF9)}
.mo{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.4);z-index:200;display:none;align-items:flex-end;justify-content:center;backdrop-filter:blur(4px)}.mo.ac{display:flex}
.ml{background:var(--w);width:100%;max-width:480px;max-height:88vh;border-radius:20px 20px 0 0;overflow-y:auto;animation:su .35s ease;padding-bottom:32px}
@keyframes su{from{transform:translateY(100%)}to{transform:translateY(0)}}
.mh2{width:36px;height:4px;background:var(--g3);border-radius:2px;margin:10px auto 0}
.mhd{padding:16px 20px 12px;border-bottom:1px solid var(--g2);display:flex;justify-content:space-between;align-items:center}
.mhd h2{font-family:'Zen Maru Gothic',sans-serif;font-size:17px;font-weight:700;color:var(--gd)}
.mc{width:32px;height:32px;border-radius:50%;border:none;background:var(--g1);font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--g5)}
.mb{padding:16px 20px}
.ski{margin-bottom:10px}.skl{display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px}.skl .nm{color:var(--g7);font-weight:500}.skl .vv{font-weight:700}
.skb{height:8px;background:var(--g1);border-radius:4px;overflow:hidden}.skf{height:100%;border-radius:4px;transition:width .8s cubic-bezier(.25,.46,.45,.94)}
.ai{background:linear-gradient(135deg,var(--gp),var(--ps) 50%,var(--bs));border-radius:var(--r);padding:16px;margin-top:12px;border:1px solid var(--gl)}
.aih{display:flex;align-items:center;gap:6px;margin-bottom:8px;font-size:13px;font-weight:700;color:var(--gd)}
.aib{background:var(--gm);color:#fff;font-size:9px;padding:2px 6px;border-radius:8px;font-weight:700}
.ai p{font-size:12.5px;line-height:1.7;color:var(--g7)}
.hl{background:rgba(46,173,109,.15);padding:1px 4px;border-radius:3px;font-weight:600;color:var(--gd)}
.im{background:rgba(255,143,171,.2);padding:1px 4px;border-radius:3px;font-weight:600;color:var(--pt)}
.ms{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:16px}
.mt{text-align:center;background:var(--g50);padding:10px 6px;border-radius:var(--r)}.mt .n{font-size:18px;font-weight:700;font-family:'Zen Maru Gothic',sans-serif}.mt .l{font-size:10px;color:var(--g5);margin-top:2px}
.mt.g .n{color:var(--gd)}.mt.p .n{color:var(--pt)}.mt.b .n{color:var(--bt)}
.tp{display:none}.tp.ac{display:block}
.ci{margin-bottom:14px}.cl{display:flex;justify-content:space-between;margin-bottom:4px}
.cn{font-size:12px;font-weight:500;color:var(--g7);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:55%}.cv{font-size:12px;font-weight:700;color:var(--gd)}
.sw{position:relative;margin-bottom:16px}.cs{width:100%;padding:10px 14px;border-radius:var(--r);border:2px solid var(--gl);background:var(--w);font-size:14px;font-family:'Noto Sans JP',sans-serif;font-weight:500;color:var(--g9);appearance:none;cursor:pointer;outline:none}.cs:focus{border-color:var(--gm)}
.saa{position:absolute;right:14px;top:50%;transform:translateY(-50%);pointer-events:none;color:var(--gm)}
.ar{border-left:4px solid var(--pa) !important}
.nd{text-align:center;padding:24px;color:var(--g5);font-size:13px}
.lu{text-align:center;padding:16px;font-size:10px;color:var(--g5)}
@keyframes fi{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.an{animation:fi .4s ease forwards}
.d1{animation-delay:.05s;opacity:0}.d2{animation-delay:.1s;opacity:0}.d3{animation-delay:.15s;opacity:0}.d4{animation-delay:.2s;opacity:0}
</style>
</head>
<body>

<div class="hd">
  <div class="hd-t"><h1>ğŸŒ¿ å–¶æ¥­ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</h1><a class="rb" href="javascript:location.reload()">ğŸ”„ æ›´æ–°</a></div>
  <div class="dl" id="upd"></div>
  <div class="pr" id="prd"></div>
</div>

<div class="tabs">
  <button class="tb a" onclick="T('ov',this)">ğŸ“Š å…¨ä½“</button>
  <button class="tb" onclick="T('rk',this)">ğŸ† ãƒ©ãƒ³ã‚­ãƒ³ã‚°</button>
  <button class="tb" onclick="T('id',this)">ğŸ‘¤ å€‹äººåˆ†æ</button>
  <button class="tb" onclick="T('al',this)">ğŸš¨ ã‚¢ãƒ©ãƒ¼ãƒˆ</button>
</div>

<div class="ct">
  <div class="tp ac" id="tp-ov">
    <div class="st an">ğŸ“ˆ å…¨ä½“ã‚µãƒãƒªãƒ¼</div>
    <div class="sg">
      <div class="sc gr an d1"><div class="lb">æ–°è¦å¥‘ç´„ç‡ï¼ˆå¹³å‡ï¼‰</div><div class="vl" id="v1">--</div><div class="sb" id="s1"></div></div>
      <div class="sc pk an d2"><div class="lb">ãƒãƒ¼ãƒ–æ–°è¦å¥‘ç´„ç‡ï¼ˆå¹³å‡ï¼‰</div><div class="vl" id="v2">--</div><div class="sb" id="s2"></div></div>
      <div class="sc bl an d3"><div class="lb">ã‚ªãƒ³ãƒ€ãƒªãƒ•ãƒˆå¥‘ç´„ç‡ï¼ˆå¹³å‡ï¼‰</div><div class="vl" id="v3">--</div><div class="sb" id="s3"></div></div>
      <div class="sc gr an d4"><div class="lb">æ–°è¦å¥‘ç´„å˜ä¾¡ï¼ˆå¹³å‡ï¼‰</div><div class="vl" id="v4">--</div><div class="sb" id="s4"></div></div>
    </div>
    <div class="st an">ğŸŒŸ ãƒˆãƒƒãƒ—ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ¼</div><div id="top" class="rl"></div>
    <div class="st an" style="margin-top:24px">âš ï¸ ã‚µãƒãƒ¼ãƒˆãŒå¿…è¦</div><div id="nds" class="rl"></div>
  </div>
  <div class="tp" id="tp-rk">
    <div class="st">ğŸ… æ–°è¦å¥‘ç´„ç‡ãƒ©ãƒ³ã‚­ãƒ³ã‚°</div><div id="rk1" class="rl"></div>
    <div class="st" style="margin-top:20px">ğŸ’° å¥‘ç´„å˜ä¾¡ãƒ©ãƒ³ã‚­ãƒ³ã‚°</div><div id="rk2" class="rl"></div>
    <div class="st" style="margin-top:20px">ğŸŒ¿ ãƒãƒ¼ãƒ–å¥‘ç´„å£²ä¸Šãƒ©ãƒ³ã‚­ãƒ³ã‚°</div><div id="rk3" class="rl"></div>
  </div>
  <div class="tp" id="tp-id">
    <div class="st">ğŸ‘¤ ã‚¹ã‚¿ãƒƒãƒ•ã‚’é¸æŠ</div>
    <div class="sw"><select class="cs" id="sel" onchange="SI()"><option value="">é¸æŠã—ã¦ãã ã•ã„</option></select><div class="saa">â–¼</div></div>
    <div id="idc"></div>
  </div>
  <div class="tp" id="tp-al">
    <div class="st">ğŸš¨ åŸºæº–æœªé”ã‚¢ãƒ©ãƒ¼ãƒˆ</div>
    <p style="font-size:12px;color:var(--g5);margin-bottom:12px">å„æŒ‡æ¨™ã§åŸºæº–å€¤ã‚’ä¸‹å›ã£ã¦ã„ã‚‹ã‚¹ã‚¿ãƒƒãƒ•ã‚’è¡¨ç¤º</p>
    <div id="al1" class="rl"></div>
  </div>
</div>
<div class="lu" id="lu"></div>

<div class="mo" id="mo" onclick="if(event.target===this)CD()">
  <div class="ml" onclick="event.stopPropagation()">
    <div class="mh2"></div>
    <div class="mhd"><h2 id="mtt">--</h2><button class="mc" onclick="CD()">âœ•</button></div>
    <div class="mb" id="mbd"></div>
  </div>
</div>

<script>
var DATA = <?!= jsonData ?>;
var D = DATA.staff;
var C = DATA.criteria;
var A = D.filter(function(s){ return s.newCount > 0 && (s.newRate > 0 || s.ondaRate > 0 || s.herbRate > 0); });

function F(n){ return n ? "Â¥" + n.toLocaleString() : "Â¥0"; }
function P(n){ return n + "%"; }
function RC(i){ return i===0?"r1":i===1?"r2":i===2?"r3":"ro"; }

function GA(s){
  var t=[],g=[];
  if(s.newRate>=60) g.push("æ–°è¦å¥‘ç´„ç‡ãŒ<span class='hl'>"+s.newRate+"%</span>ã¨éå¸¸ã«é«˜ã„");
  else if(s.newRate>=C.newRate) g.push("æ–°è¦å¥‘ç´„ç‡ãŒåŸºæº–ã‚’ã‚¯ãƒªã‚¢");
  else if(s.newRate>0) t.push("æ–°è¦å¥‘ç´„ç‡ãŒ<span class='im'>"+s.newRate+"%</span>ï¼ˆåŸºæº–"+C.newRate+"%ï¼‰ã€‚ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°ãƒˆãƒ¼ã‚¯ã‚’è¦‹ç›´ã—ã¾ã—ã‚‡ã†");
  else t.push("å…ˆè¼©ã®ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ã§<span class='im'>æˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³</span>ã‚’å­¦ã³ã¾ã—ã‚‡ã†");
  if(s.unitPrice>=100000) g.push("å¥‘ç´„å˜ä¾¡<span class='hl'>"+F(s.unitPrice)+"</span>ã§é«˜å˜ä¾¡ç¶­æŒ");
  else if(s.unitPrice>=C.unitPrice) g.push("å¥‘ç´„å˜ä¾¡ã¯åŸºæº–ä»¥ä¸Š");
  else if(s.unitPrice>0) t.push("å¥‘ç´„å˜ä¾¡<span class='im'>"+F(s.unitPrice)+"</span>ã¨ã‚„ã‚„ä½ã‚");
  if(s.ondaRate>=67) g.push("ã‚ªãƒ³ãƒ€ãƒªãƒ•ãƒˆç‡<span class='hl'>"+s.ondaRate+"%</span>ã§å„ªç§€");
  else if(s.ondaRate>=C.ondaRate) g.push("ã‚ªãƒ³ãƒ€ãƒªãƒ•ãƒˆç‡ãŒåŸºæº–ã‚¯ãƒªã‚¢");
  else if(s.ondaCount>0&&s.ondaRate>0) t.push("ã‚ªãƒ³ãƒ€ãƒªãƒ•ãƒˆç‡ã‚’ã‚‚ã†å°‘ã—ä¸Šã’ãŸã„ã¨ã“ã‚");
  if(s.herbRate>=50) g.push("ãƒãƒ¼ãƒ–ç‡<span class='hl'>"+s.herbRate+"%</span>ã§è‰¯å¥½");
  else if(s.herbRate>=C.herbRate) g.push("ãƒãƒ¼ãƒ–ç‡ãŒåŸºæº–ã‚¯ãƒªã‚¢");
  else if(s.herbRate>0&&s.herbRate<C.herbRate) t.push("ãƒãƒ¼ãƒ–ã®å¥‘ç´„ç‡ã«ä¼¸ã³ã—ã‚ã‚ã‚Š");
  else if(s.herbRate===0&&s.herbNew>0) t.push("<span class='im'>ä½“é¨“ãƒ¡ãƒ‹ãƒ¥ãƒ¼</span>ã®ææ¡ˆã‚’æ„è­˜ã—ã¾ã—ã‚‡ã†");
  if(s.herbSales>=200000) g.push("ãƒãƒ¼ãƒ–å£²ä¸Š<span class='hl'>"+F(s.herbSales)+"</span>ã§ç´ æ™´ã‚‰ã—ã„");
  if(s.newCount>=8) g.push("æ‹…å½“æ•°<span class='hl'>"+s.newCount+"äºº</span>ã¨é›†å®¢åŠ›ãŒé«˜ã„");
  else if(s.newCount<=2) t.push("æ‹…å½“æ•°ãŒå°‘ãªã‚");
  var h="";
  if(g.length>0) h+="<p style='margin-bottom:8px'><strong>ğŸ’ª å¼·ã¿ï¼š</strong>"+g.join("ã€‚")+"ã€‚</p>";
  if(t.length>0) h+="<p><strong>ğŸ¯ æ”¹å–„ãƒã‚¤ãƒ³ãƒˆï¼š</strong>"+t.join("ã€‚")+"ã€‚</p>";
  if(g.length>0&&t.length===0) h+="<p style='margin-top:8px'>ğŸŒŸ ç´ æ™´ã‚‰ã—ã„ï¼ã“ã®èª¿å­ã§ï¼</p>";
  if(g.length===0&&t.length>0) h+="<p style='margin-top:8px'>ğŸ’¡ ä¸€ã¤ãšã¤æ”¹å–„ã™ã‚Œã°å¤§ä¸ˆå¤«ï¼</p>";
  return h;
}

function mkRow(s,i,mode){
  var div=document.createElement("div");
  div.className="sr"+(mode==="s"?" ar":"");
  div.onclick=function(){OM(s.name)};
  div.innerHTML='<div class="rb2 '+(mode==="s"?"ro":RC(i))+'">'+(mode==="s"?"!":(i+1))+'</div><div class="si"><div class="sn">'+s.name+'</div><div class="ss2"><div class="s1 gr">å¥‘ç´„ç‡ <span>'+s.newRate+'%</span></div><div class="s1 pk">å˜ä¾¡ <span>'+F(s.unitPrice)+'</span></div></div><div class="pb"><div class="pf '+(mode==="s"?"pk":"gr")+'" style="width:'+Math.min(s.newRate,100)+'%"></div></div></div><div class="sa">\u203A</div>';
  return div;
}

function RR(id,key,fm){
  var so=A.filter(function(s){return s[key]>0}).sort(function(a,b){return b[key]-a[key]}).slice(0,8);
  var mx=so.length>0?so[0][key]:1;
  var el=document.getElementById(id);
  if(so.length===0){el.innerHTML='<div class="nd">ğŸ“­ ãƒ‡ãƒ¼ã‚¿ãªã—</div>';return;}
  el.innerHTML=so.map(function(s,i){return '<div class="ci"><div class="cl"><span class="cn">'+(i+1)+'. '+s.name+'</span><span class="cv">'+fm(s)+'</span></div><div class="pb"><div class="pf '+(i<3?"gr":i<6?"bl":"pk")+'" style="width:'+(s[key]/mx*100)+'%"></div></div></div>';}).join("");
}

function RD(s,tid){
  var sk=[{l:"æ–°è¦å¥‘ç´„ç‡",v:s.newRate,t:C.newRate},{l:"ã‚ªãƒ³ãƒ€ãƒªãƒ•ãƒˆå¥‘ç´„ç‡",v:s.ondaRate,t:C.ondaRate},{l:"ãƒãƒ¼ãƒ–æ–°è¦å¥‘ç´„ç‡",v:s.herbRate,t:C.herbRate}];
  var h='<div class="ms"><div class="mt g"><div class="n">'+s.newCount+'</div><div class="l">æ–°è¦æ‹…å½“æ•°</div></div><div class="mt p"><div class="n">'+F(s.unitPrice)+'</div><div class="l">å¥‘ç´„å˜ä¾¡</div></div><div class="mt b"><div class="n">'+F(s.herbSales)+'</div><div class="l">ãƒãƒ¼ãƒ–å£²ä¸Š</div></div></div><div class="st" style="font-size:13px">ğŸ“Š ã‚¹ã‚­ãƒ«ãƒãƒ©ãƒ³ã‚¹</div><div>';
  sk.forEach(function(k){var ok=k.v>=k.t;h+='<div class="ski"><div class="skl"><span class="nm">'+k.l+'</span><span class="vv" style="color:'+(ok?"var(--gm)":"var(--pt)")+'">'+k.v+'%'+(ok?" \u2713":" (åŸºæº–"+k.t+"%)")+'</span></div><div class="skb"><div class="skf" style="width:'+k.v+'%;background:'+(ok?"linear-gradient(90deg,var(--gm),#4FD080)":"linear-gradient(90deg,var(--pa),#FFB6C8)")+'"></div></div></div>';});
  h+='</div><div class="ai"><div class="aih">ğŸ¤– AIã‚¢ãƒ‰ãƒã‚¤ã‚¹ <span class="aib">AI</span></div>'+GA(s)+'</div>';
  document.getElementById(tid).innerHTML=h;
}

function init(){
  document.getElementById("upd").textContent=DATA.updated;
  document.getElementById("prd").textContent="é›†è¨ˆæœŸé–“ï¼š"+DATA.period.start+" ã€œ "+DATA.period.end;
  document.getElementById("s1").textContent="åŸºæº–: "+C.newRate+"%";
  document.getElementById("s2").textContent="åŸºæº–: "+C.herbRate+"%";
  document.getElementById("s3").textContent="åŸºæº–: "+C.ondaRate+"%";
  document.getElementById("s4").textContent="åŸºæº–: Â¥"+(C.unitPrice||0).toLocaleString();
  document.getElementById("lu").textContent="æœ€çµ‚æ›´æ–°: "+DATA.updated;

  if(A.length===0){
    ["v1","v2","v3","v4"].forEach(function(id){document.getElementById(id).textContent="--"});
    document.getElementById("top").innerHTML='<div class="nd">ğŸ“­ ã¾ã ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div>';
    document.getElementById("nds").innerHTML='<div class="nd">ğŸ“­ ã¾ã ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div>';
  } else {
    var an=Math.round(A.reduce(function(a,s){return a+s.newRate},0)/A.length);
    var ha=A.filter(function(s){return s.herbNew>0}),ah=ha.length?Math.round(ha.reduce(function(a,s){return a+s.herbRate},0)/ha.length):0;
    var oa=A.filter(function(s){return s.ondaCount>0}),ao=oa.length?Math.round(oa.reduce(function(a,s){return a+s.ondaRate},0)/oa.length):0;
    var pa=A.filter(function(s){return s.unitPrice>0}),ap=pa.length?Math.round(pa.reduce(function(a,s){return a+s.unitPrice},0)/pa.length):0;
    document.getElementById("v1").textContent=an+"%";document.getElementById("v2").textContent=ah+"%";
    document.getElementById("v3").textContent=ao+"%";document.getElementById("v4").textContent=F(ap);
    var topEl=document.getElementById("top");topEl.innerHTML="";
    A.slice().sort(function(a,b){return b.newRate-a.newRate}).slice(0,3).forEach(function(s,i){topEl.appendChild(mkRow(s,i,"t"))});
    var nh=A.filter(function(s){return s.newRate<C.newRate&&s.newCount>=3}).sort(function(a,b){return a.newRate-b.newRate}).slice(0,3);
    var ndsEl=document.getElementById("nds");
    if(nh.length>0){ndsEl.innerHTML="";nh.forEach(function(s,i){ndsEl.appendChild(mkRow(s,i,"s"))})}
    else ndsEl.innerHTML='<div style="text-align:center;padding:12px;color:var(--g5);font-size:13px">åŸºæº–æœªé”ãªã— ğŸ‰</div>';
  }
  RR("rk1","newRate",function(s){return P(s.newRate)});RR("rk2","unitPrice",function(s){return F(s.unitPrice)});RR("rk3","herbSales",function(s){return F(s.herbSales)});
  var als=[];D.filter(function(s){return s.newCount>0}).forEach(function(s){
    var is=[];if(s.newRate>0&&s.newRate<C.newRate)is.push("æ–°è¦å¥‘ç´„ç‡ "+s.newRate+"%(åŸºæº–"+C.newRate+"%)");
    if(s.ondaCount>0&&s.ondaRate>0&&s.ondaRate<C.ondaRate)is.push("ã‚ªãƒ³ãƒ€ãƒªãƒ•ãƒˆç‡ "+s.ondaRate+"%(åŸºæº–"+C.ondaRate+"%)");
    if(s.herbNew>0&&s.herbRate>0&&s.herbRate<C.herbRate)is.push("ãƒãƒ¼ãƒ–ç‡ "+s.herbRate+"%(åŸºæº–"+C.herbRate+"%)");
    if(s.newRate===0&&s.newCount>=3)is.push("æ–°è¦å¥‘ç´„ç‡ 0%");
    if(is.length>0)als.push({name:s.name,issues:is})});
  var alEl=document.getElementById("al1");
  if(als.length>0){alEl.innerHTML="";als.forEach(function(a){var d=document.createElement("div");d.className="sr ar";d.onclick=function(){OM(a.name)};d.innerHTML='<div class="rb2 ro" style="background:var(--ps);color:var(--pt)">\u26A0</div><div class="si"><div class="sn">'+a.name+'</div><div style="font-size:10px;color:var(--pt);margin-top:3px">'+a.issues.join(" / ")+'</div></div><div class="sa">\u203A</div>';alEl.appendChild(d)})}
  else alEl.innerHTML='<div class="nd">\u2705 ã‚¢ãƒ©ãƒ¼ãƒˆãªã—</div>';
  var sel=document.getElementById("sel");
  D.filter(function(s){return s.newCount>0}).sort(function(a,b){return a.name.localeCompare(b.name,"ja")}).forEach(function(s){var o=document.createElement("option");o.value=s.name;o.textContent=s.name;sel.appendChild(o)});
}

function SI(){var n=document.getElementById("sel").value;if(!n){document.getElementById("idc").innerHTML="";return}var s=D.find(function(x){return x.name===n});if(s)RD(s,"idc")}
function OM(n){var s=D.find(function(x){return x.name===n});if(!s)return;document.getElementById("mtt").textContent="\uD83D\uDCCB "+s.name;RD(s,"mbd");document.getElementById("mo").classList.add("ac");document.body.style.overflow="hidden"}
function CD(){document.getElementById("mo").classList.remove("ac");document.body.style.overflow=""}
function T(t,b){document.querySelectorAll(".tp").forEach(function(p){p.classList.remove("ac")});document.querySelectorAll(".tb").forEach(function(x){x.classList.remove("a")});document.getElementById("tp-"+t).classList.add("ac");b.classList.add("a")}
init();
</script>
</body>
</html>
